Bootstrap: docker
From: continuumio/miniconda3:4.9.2

%help
"LongQC v1.2 image"

%labels
MAINTAINER "Guillermo R. Piccoli <grpiccoli@gmail.com>"

%post
BIN=/usr/local/bin

## Installations
apt-get clean all
apt-get update
apt-get install -y  \
git=1:2.20.1-2+deb10u3 \
build-essential=12.6 \
libc6-dev=2.28-10 \
zlib1g-dev=1:1.2.11.dfsg-1
apt-get clean
apt-get purge

wget -qO- https://github.com/yfukasawa/LongQC/archive/refs/tags/1.2.0b.tar.gz | tar zxvf -
cd LongQC-1.2.0b/minimap2-coverage && \
make && \
cd && \
mv LongQC-1.2.0b/* $BIN

conda install -y \
python=3.9 \
numpy=1.20.1 \
pandas=1.2.4 \
scipy=1.6.2 \
jinja2=2.11.3 \
h5py=2.10.0 \
matplotlib=3.3.4 \
scikit-learn=0.24.1

conda config --add channels defaults && \
conda config --add channels conda-forge && \
conda config --add channels bioconda

conda install -y -c bioconda \
edlib=1.2.3 \
pysam=0.16.0.1 \
python-edlib=1.3.8.post2